<div class="main-container">
<section class="projects-page container">
  <h1>Projekte</h1>
  <div class="projects-grid">
    <article class="project-card" *ngFor="let project of projects; trackBy: trackByTitle" [class.has-multiple-images]="project.images && project.images.length > 1">
      <div class="project-images" *ngIf="project.images && project.images.length > 1; else singleImage">
        <img *ngFor="let img of project.images; trackBy: trackByIdentity" [src]="img" [alt]="project.title" class="project-image" />
      </div>
      <ng-template #singleImage>
        <img class="project-image" [src]="project.image" [alt]="project.title" />
      </ng-template>
      <div class="project-content">
        <h2>{{ project.title }}</h2>
        <p>{{ project.description }}</p>
        <ul class="tech-list">
          <li *ngFor="let tech of project.technologies; trackBy: trackByIdentity">{{ tech }}</li>
        </ul>
        <div class="project-actions">
          <a *ngIf="project.link" class="project-link" [href]="project.link" target="_blank" rel="noopener">{{ project.linkLabel || 'Live ansehen' }}</a>
          <a *ngIf="project.github" class="project-github" [href]="project.github" target="_blank" rel="noopener" aria-label="GitHub Repository">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
            GitHub
          </a>
          <button *ngIf="project.play" class="btn-play" (click)="openGame(project)">Play</button>
        </div>
      </div>
    </article>
  </div>
</section>
<section class="game-embed">
<h2>Lost Files – Play</h2>
  <ng-container *ngIf="playingProject; else previewTpl">
    <div class="embed-header">
      <h3>{{ playingProject.title }}</h3>
      <button class="btn-close" (click)="closeGame()">Schließen</button>
    </div>
    <div class="iframe-wrapper">
      <ng-container *ngIf="!loadError; else errorTpl">
        <iframe
          [src]="trustedGameUrl"
          title="{{ playingProject.title }}"
          loading="lazy"
          referrerpolicy="no-referrer"
          sandbox="allow-scripts allow-pointer-lock allow-same-origin"
          (load)="onIframeLoad()"
          (error)="loadError = true"
        ></iframe>
        <div class="overlay" *ngIf="loading">
          <p>Lädt Spiel…</p>
        </div>
      </ng-container>
      <ng-template #errorTpl>
        <div class="iframe-error">
          <p>Das Spiel konnte nicht geladen werden. <a href="#" (click)="openDirect($event)">Direkt öffnen</a></p>
        </div>
      </ng-template>
    </div>
  </ng-container>
  <ng-template #previewTpl>
    <p>Klicke auf "Play", um es hier zu starten.</p>
  </ng-template>
</section>
</div>


